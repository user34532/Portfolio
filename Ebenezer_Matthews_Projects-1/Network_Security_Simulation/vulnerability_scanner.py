import nmap

# Function to scan the target network for open ports and vulnerabilities
def scan_target(target):
    scanner = nmap.PortScanner()
    print(f"Scanning target {target} for open ports...")
    scanner.scan(target, '22-1024')  # Scan ports from 22 to 1024
    return scanner[target]

# Function to report vulnerabilities
def report_vulnerabilities(scan_results):
    vulnerabilities = []
    for protocol in scan_results['protocols']:
        for port in scan_results['all_tcp']:
            port_info = scan_results['tcp'][port]
            if port_info['state'] == 'open':
                vulnerabilities.append(f"Port {port} is open: {port_info['name']} service")
    return vulnerabilities

if __name__ == "__main__":
    target = input("Enter the IP address of the target: ")
    scan_results = scan_target(target)
    vulnerabilities = report_vulnerabilities(scan_results)
    if vulnerabilities:
        print("Vulnerabilities detected:")
        for vulnerability in vulnerabilities:
            print(vulnerability)
    else:
        print("No vulnerabilities detected.")